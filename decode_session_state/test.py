import ctypes
from subprocess import Popen, PIPE

file = "./decodess.dll"

out = Popen(args="nm "+file, shell=True, stdout=PIPE) \
        .communicate()[0] \
        .decode("utf-8")

attrs = [
    i.split(" ")[-1].replace("\r", "")
    for i in out.split("\n") if " T " in i
]

lib = ctypes.cdll.LoadLibrary(file)

functions = [i for i in attrs if hasattr(lib, i)]
print(functions)

f = lib.decode_state
f.argtypes = [ctypes.c_char_p, ctypes.c_char_p]
f.restype=ctypes.c_char_p

secret = b"1234567890123456"
encoded = b"KgfjpsgBTLRKXpBu8lru08_kRKkBSHSReXcFBOi6ORVLtZhtMXffrIcdqHBxcbXFr3_nJL8SgXM2iuvf8EeqqkSWExD7-PNvIQFr2HPoXxMLqTeCWAbi5eBDjeU99oYLU_QksBY3IMHWPZzHjHgRD7LU63ay4Ldcc1W5_oWIYqhJoKBOCSJPTxbiTzJfUuA-fHkAs8IWlKfN8D7Qb_8TK8Dc3jHfFRobJ2MkAYN2HesL_SE2naNwXMrcCp12aVFUaPSL5WmX-zrKpDaIq8tgVC4jNZ2hmw7pD5VS33fkgir67ZHSic-_HEknRvNZl64rm5paA6nZJaQPa6pVegbo8o8IYX9kb2HP4NeAvBOkF9r9_t6NTA0ej0SO1Y9SpkgWc1hhdLgFs9PTdRgdjfOytNaJcTrMLUWGB7SeEUHgRgFEV5g43Ct_ysNIdn8pRZOkiq6DtcpwUdUtxvEHDNHUSW0q6T6OzsWINPdRd8FHqJ4RzTukKQDv4ik2ke8U5Kp_jIYK7Kd_nM90BXczp3oFoLx1Uo6HKJ3B4srDrVLEcgk3KmxagibWWCokrb1jNxXwv8qJ2pVrYQYAqkRkbLM7zcXiXuG0N6VfZCLnw_9t-h3ry-xhF6CdDKTFeVkJXMYxxO9JwIAT0ERD73TGD12zCis_SAbUUKmSkZqs0eUNufxOp9RIkmGRaP9WtJQdQ6yu4QTxFntglAlOf3tkBKj9Au5nfUnZafS4P1T8v5vBoTSTE1yvMcv3IX_hWY8h27zV6lYOxGFibRPDfcirDnwkBikzi37bxBuZqYhpD3ECWfby0RbLrzicRoaJ1P--mlkq57IvjsBKauyPOEjw9O1lcJ_WQL2T2JmKBJNS3RkxwfvjPV4dviXUYzVpeFLvYZYf2IQdmxuTmCk6snazALAwob3TZiXOKAO7eo_Z1H1crSf8jkQ7LDJNFUXMEKL51hYyvsOd562D1DQF5e90OJNkWqA-U1xA5T9Oq4CFH7i4Qje8TTrcPSnpePHAxPnI7BAgJxA9iHCEDj6P0Wcj7M9f2CrXPCMRXGjep9vM66ticYMO0IqzQfG8iZHhLZ26Nzq-WZYEJcITvgkmPVM8kGFSGDvP3kUpS-dxL6fTQcZiannrB3kHOJcJRLczNjCMJlTv7k1_SBaoFs_6WB4lyLGDJ-LgpTVg9hh1n7qyd-tFNtTudC-rsh9p4NjYEtUzmPocKEEmKcPaV4l68gxnNjctA2UyIpMHa_6vG7jSe0dFdxYzasPQsx-Ip4w6W7J6NP1NGPUSE7c3rJON-8PcYXDtRD5XOnu-NZvzcoIq8BBNEGy3jsVmlo6F27dV1bUp1w1s1cF5cjSaTZPy5ocEH_IWPbAvmhs5_sCGFakEN8eGoOhp0N04K47dwr6enFTLT8WrvtyzK7r7CPaI1m9s3WGSSkQJGQYL8deLFM2cJ9FRRpW0_Wzt_PyRnE4NT567t418qiNrjerbhmHfVQ92h5f1lv_9-wcF_m93xAWYXwv-jTWXXMSnizZYoYu7F-vJgcRhYrp545Foa-7e7Wzr-lYwZN8m4Sx8APmJKPxFxqRr8RJEQpXwqolnBJlaZ90gbNEKS03cGS-tfPvcDu3dAn4mxN8Z_9fzc0sGJKjAhlyP5xH4qDd0hzrQyhyPJakw6RguXXDTtBnor759K4mJemeoMTM1gtRuPVcNzOuCRdTKefo_MeLpJOLRxMef0GZZ1cSbq8lE5vY5VAUQXFSSwyrgVpfAXaPCPu4x0FY1fFAXB5SrRdz3CC_ILaYc8z7pv5n7bsTJ6tePxo4VEwl9NAY2VQhm6bTs33_M7hCOvCMbiUNCgwd1i6-dZRaWEERurCStVbHkKsfOsGWA41sKjRyaJ6fCl6D9-NgD37KQs6cL84_1uEgCWal8CwOJ5Ux7bNGA-yrHVbYfSLhqZFxbUhMG-Gp9n6kz-dHkmszsTDVfHasPal4Fzwtxipf8soohSL51hSqBjK63ouTIsqVCqCqak4p_tBYIT1l8IJgrYvJXX5uBEei7SaKxUW5Y8wMM26I_3TDRUU-F7SKyb7qhHXJd2FhryAsleg7TlneKwkxcNzHq0KQ4SZAAl84d53cZDkR1yR-TcIA7SA4-YkrgXafnpJPI2DF2-Zcnd-E8O4muNJVr_OPPPMpmgJQvE5dC-hy9ut99ILQTUzmE3y9L3Y6YmJzup8GdRmJOVpU0SWxlwMWp0_RtmbXtQurmtP0NKrrGKb7WsiI8-QFO8Pwr53_CF8P7pOW_pO4FeQAqQyUsogJugYnaMG7tiO__SIeSxd3lI8A9cvrhpRw4krdxxlKScZBPPzEM8vJV-KMxqkbSCgv0B92qOP2KbT1PNCxwY-5Z45RdYGR0KG0v7TaZlu7AgtrBM8HMAGCd895TXJDMTpxQLdQ8vErbTIbBLZkqxZtJdiEceS6vj3ZNKhOCRBBPCvxzQfmZUXwf2d9Zcvj-LRNQFFNPxGLBYpj6oT0LzPFf9RaxUG64tZqvrqkdsKTtB2ry2Mndju3jRWRhkUr-XJyDStxcJ195XEDa4Wi3_STgJasLoMyWa-c16pXCnVUq9G2X6gN7G8p2c34vpn-yYlceHCKinvN5FKKvI8bzCfinnefeKmPaL3iBIjaNRIUVNqoFFWXdnnSKHwGTGa3nAIG02z3VfAKRx4PC-WN0KJcL9AmwJXDnccv-1yygrisJtiBZwIq-7H9t1_x0zytTn7-_LF281Dp_M8Qgru5x7WFZnIiCCz7GCxyKMg5V35Q86TR4oreWfAXHBx8e8yXaiDvI8SPWJl8rlM77nULAxTfJaxB5JP4Lq3a6cowiJT3tKF-MTNBnwHqtGVAmsuh1pbxg4EY2XEF1P8jooTgxztgYYqd2DUDNJOa8YTGv_VP10OUOPYEEBSAHR49QQs5YDd2mjUtn31NndyWbYBTtCpn5rOR7D6BS038IskG2UdBIlo-Hu6Qgk1opG1LZ9KvhgELp1gX2u3rmGNsEIJuECBp3rJq2PmOgMpAqQsqo9phCxHiGEROC9onyhleuA19R9J6AYiB2uPBRN7XLkUX5JZlSSR85V-MXRVoiCZjAyhJXcMSA5ZgcfEjz5MvhY6ZtD4dAuVbhhVQJOSDqW82iTeJ3wMG04tDFEblVHp0s6T7uetbPhmkbPunghoPC8uGgJWKWyte-WYUKOCaJC_BXtgJR9WD8xMheIyYAWi17NmX-FV0r64tGZSXn7_TgdE_n8P6PAEjMQJXWQs_VAee3T18Ep7sdPW4sgsq6v8IkgE7E95bP1VnOptKLRdq085IJaGc6nUUiFKW1sxpZEzfUIuTHO2YDS8-ur4EFD7Ee_gjsG5V0yHfpeg=="
result = f(secret, encoded)
print(result.decode(encoding='utf-8'))